<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>测试反爬虫</title>
</head>
<body>
  <div id="result">测试数据...</div>
</body>
<!-- <script src="http://zeptojs.com/zepto.min.js"></script> -->
<!-- <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script> -->
<script src="jquery-3.1.0.min.js"></script>
<script>
$(function(){
  var $result = $('#result');
  var clientDemo = function(){
    var start = +new Date;
    $.ajax({
      async: false,
      url: '/key',
      type: "GET",
      dataType: 'jsonp',
      jsonp: 'callback',
      // cache: false,
      success: function(key){
        //这里的 key 已经被 jsonp 执行处理过，是正确的 key，但如果未处理过，直接访问 /key 去获取，返回的就是一个处理的数据，不是真正的 key
        // console.log(key);
        $.ajax({
          url: '/data',
          data: {
            key: key
          },
          success: function(data){
            $result.append('<br>' + data);
            var end = +new Date;
            console.log( (end-start)/1000 );
          },
        })
      },
    });
  }

  setInterval(clientDemo, 2000);

})
</script>
</html>
